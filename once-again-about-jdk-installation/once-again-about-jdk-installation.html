<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>Еще раз о JOIN</title>
	</head>
	<body>
		<h1>
			<big>
				<a href="/" title="Перейти на главную страницу">&#8962;</a>
			</big>
		</h1>
		
		<hr>
		
		<h1>
			<a href="http://flaz14.github.io/once-again-about-jdk-installation/once-again-about-jdk-installation.html">
				Еще раз о об установке JDK
			</a>
		</h1>
			
		<h2>Downloading</h2>
		
		<p>
			Зайдем на официальный сайт <a href="www.oracle.com">Oracle</a>. Затем наведем курсов на 
			<strong>Downloads</strong>, затем в выпадающем списке нажмем на <strong>Java for Developers</strong>. Далее
			нажмем на большую кнопку с логотипом Java и подписью <strong>Java Platform (JDK) xxx / yyy</strong>. 
			Откроется страничка с таблицей для разных ОС и архитектур процессоров. Например, для Linux x64 предлагается 
			скачать или rpm-пакет, или тарбол. rpm-пакет не всегда подходит (например, в случае с Ubuntu; да, преобразовать rpm
			в deb возможно, но лучше этого не делать). Так что скачаем тарбол. Все, у нас есть самый что ни на есть официальный 
			дистрибутив: не из какого-нибудь зеркала или репозитория, а от самой Oracle (правда, контрольные сумму для 
			скачанного архива приходится проверять вручную).
			
		<h2>Installation</h2>
		
		<p>
			Теперь надо распаковать тарбол и разобраться с переменными окружения (в большинстве случаев достаточно добавить 
			подкаталог bin распакованного JDK в переменную окружения PATH, но можно еще и создать переменную окружения JAVA_HOME, чтобы она
			указывала на распакованный JDK. Можно эти переменные установить для всех пользователей, можно создать символическую 
			ссылку, что-нибудь вроде JAVA_CURRENT, а затем, если понадобиться на время активировать другую версию Java, изменить
			только эту ссылку и еще много всего. 

		<p>
			Тарбол же можно распаковать ~/bin. А можно и в /usr/local/java к примеру. Достоинство последнего подхода - 
			никто, кроме root, не сможет изменить файлы установленного JDK. Также есть смысл создать в каталоге с установленным
			JDK подкаталог src, и в него распаковать содержимое файла src.zip. Эта возня окупится, когда понадобится 
			быстро взглянуть на исходный код JDK, например, с помощью grep. Затем открыть исходник найденного класса в 
			текстовом редакторе с графическим интерфейсом, не боясь при этом что-либо испортить (еще один плюс использования
			/usr/local/... или чего-нибудь аналогичного, например, /opt). Но как всегда, есть нюансы.
			
		<h2>Западня №1</h2>
			Мы, как настоящие линуксоиды, лишних команд не пишем. Пусть мы скачали JDK в ~/Downloads. Теперь, чтобы поместить
			содержимое тарбола в /usr/local/java достаточно выполнить (от root, естественно):
<pre>
david$ sudo tar --extract --directory /usr/local/java/ --file ~/Downloads/jdk-8u111-linux-x64.tar.gz	
</pre>
			Ну, вроде бы все готово. Но посмотрим на целевой каталог
<pre>
david$ ll /usr/local/java/
total 12K
drwxr-xr-x  3 root root 4,0K Nov 29 20:40 .
drwxr-xr-x 15 root root 4,0K Nov 29 20:35 ..
drwxr-xr-x  8 uucp  143 4,0K Sep 23 02:27 jdk1.8.0_111
</pre>

			Владелец почему-то uucp, а группа вообще без имени (grep '143' /etc/group - ничего не найдет). Ничего удивительного 
			нет: поскольку tar был запущен с правами root, он распаковал тарбол таким, каким он был (у обычного пользователия так 
			бы не получилось). Так не пойдет: 
			такие странные права доступа не очень хороши для безопасности, но и просто некрасивы.
			
			Что ж, придется усложнить команду:
<pre>
	tar --extract --directory /tmp --file ~/Downloads/jdk-8u111-linux-x64.tar.gz && sudo mv /tmp/jdk1.8.0_111 /usr/local/java
</pre>

			Посмотрим, что получилось:
<pre>
	drwxr-xr-x  8 david david 4,0K Sep 23 02:27 jdk1.8.0_111
</pre>
			Опять не то, что надо. Хотя все предсказуемо: распаковали тарбол мы от имени обычного пользователя (david), 
			а переместили получившиеся файлы от имени root (который заботливо сохранил оригинальные права доступа к перемещаемому каталогу).
			
			Придется еще усложнить команду. Например, сделаем так:
<pre>
david$ tar --extract --directory /tmp --file ~/Downloads/jdk-8u111-linux-x64.tar.gz && sudo cp -r /tmp/jdk1.8.0_111 /usr/local/java && rm -rf -- /tmp/jdk1.8.0_111/
</pre>
	
			Не очень элегантно получилось (особенно меня расстраивает наличие rm -rf).
			Хорошо хоть результат получился что надо:
<pre>
drwxr-xr-x  8 root root 4,0K Nov 29 20:53 jdk1.8.0_111
</pre>

			Так что придется решение по-красивше
			
		<h2>Теперь точно ничего лишнего</h2>
			__________
		
		
		<h1>
			<big>
				<a href="#" title="Перейти к началу страницы">&uarr;</a>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				<a href="/" title="Перейти на главную страницу">&#8962;</a>
			</big>
		</h1>
	</body>
</html>
