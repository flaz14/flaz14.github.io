<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>"Креативные" сообщения в Skype. Часть 2</title>
	</head>
	<body>
		<h1>
			<big>
				<a href="/" title="Перейти на главную страницу">&#8962;</a>
			</big>
		</h1>
		
		<hr>
		
		<h1>
			<a href="http://flaz14.github.io/skype-extra-messaging/skype-extra-messaging-part-2.html">
				"Креативные" сообщения в Skype. Часть 2
			</a>
		</h1>
		
		<h3>[2017, Март]</h3>
		
		<h3>
			<a href="skype-extra-messaging-part-1.html">Часть 1</a>
			|
			<a href="тут будет ссылка на исходный код">
				Исходный код
			</a>
		</h3>
		
		<h2>Ограничения</h2>
		
		<p>
			<ol>
				<li>
					<h4>Ограниченная длина строки</h4>
					
					<p>
						Если строка в сообщении <sup id="footnote-1-top"><a href="#footnote-1-bottom">[1]</a></sup> 
						очень длинная, то Skype разбивает ее по границам слов (т.е. пробелам). Если же строка не 
						содержит пробелов и при длина ее превышает ширину области сообщений, Skype все равно разбивает 
						такую строку <sup id="footnote-2-top"><a href="#footnote-2-bottom">[2]</a></sup>. Нужно 
						использовать строки умеренной длины. Опытным путем было выяснено, что 7 смайликов отлично 
						помещаются и отображаются безо всяких переносов.
					
				<li>
					<h4>Ограниченная длина сообщения</h4>
					
					<p>
						Если сообщение очень длинное, то Skype обрезает его до определенного количества символов, а 
						вместо оставшихся многоточие <tt>...</tt> (по крайней мере, в версии для Linux). Возможно, в 
						Web-приложении ограничений на длину сообщения нет (бесконечная прокрутка нынче в моде). Опытным
						путем было выяснено, что в версии для Linux (при использовании буков размером 7x7 смайликов) 
						ограничение составляет 327 строк. А вот уже 328-ая строка обрезается (оставшиеся в последней 
						строке смайлики превращаются в простой текст, а лишние символы многоточием). В Web-приложение
						длинное сообщение вообще не отобразилось 
						<sup id="footnote-3-top"><a href="#footnote-3-bottom">[3]</a>.
			</ol>
		
		<p>
			Как уже стало ясным, ограничения могут быть разными для различных версий Skype. Кроме того, ограничения 
			могут меняться, как говорится, без предварительного уведомления пользователя. 7x7 - достаточный размер для 
			"смайликового" (по сути дела, растрового) шрифта. Хотя плавность линий при таком низком разрешении будет 
			страдать.
			
		<h2>"Рисуем" буквы</h2>
	
		<p>
			Сделаем сначала заготовку. Она будет состоять из семи строк по семь символов в каждой строке. В качестве 
			"белого" пикселя возьмем <b>-</b> <sup id="footnote-4-top"><a href="#footnote-4-bottom">[4]</a>, а в 
			качестве "черного" воспользуемся <b>*</b>. Оставим по одному ряду "белых" пикселей сверху и снизу, чтобы 
			после соедениния букв в слово они не слипались (и не только для этого: лишний ряд окажется совсем нелишним 
			для особенных букв, таких как <b>Й</b> и <b>Ё</b>). Вот, к примеру, буква <b>А</b>:
			
<pre>
-------
--***--
-*---*-
-*****-
-*---*-
-*---*-
-------
</pre>	
		
		<p>
			Да, очертания буквы <b>А</b> получилось сделать плавными. А буквы <b>Й</b> вместо "шляпки" будет просто один
			"черный" пиксель. Букву <b>Ж</b> никак не получилось сделать симпатичной. А буквы <b>Ш</b> и <b>Щ</b> не 
			получилось сделать контрастными: "хвостик",	характертный для <b>Щ</b> - это	один единственный пиксель! Как 
			бы то ни было, алфавит можно увидеть в файле 
			<a href=
			"https://github.com/flaz14/flaz14.github.io/blob/master/skype-extra-messaging/code/abc.txt">abc.txt</a>. Или
			можно взять готовый шрифт. Или сгенерировать с каким угодно стиле на сайтах вроде 
			<a href="http://patorjk.com/software/taag/#p=display&f=Graffiti&t=Type%20Something%20">
			Text to ASCII Art Generator (TAAG)</a>. 
				
		<h2>Переводим текст в смайлики</h2>
		
		<p>
			Наверное, самый простой путь - взять в качестве "цвета" фона обычный смайлик <b>:)</b>, а в качестве "цвета"
			шрифта - мишку <b>(hug)</b>. Добавить смайлики несложно. Достаточно заменить везде в тексте <b>-</b> на 
			<b>:)</b>, а <b>*</b> на <b>(hug)</b>. 
			
			Наверное, это наиболее подходящие смайлики. Потому что обычный смайлик - самый распространенный, а мишка 
			хорошо подходит в качестве приветствия. Но самое главное, что цвет мишки (в основном бурый) и цвет улыбки
			(в осносном желтый) сильно отличаются. Буква хорошо заметна. Сравните буквы "П", набранные контрастными с
			майликами и неконтрастными смайликами. Они изображены на <a href="#illustration-1">рисунке 1</a>.
			
			<h4 id="illustration-1">Рисунок 1</h4>
			<p>
				<img src="illustrations/contrast-smileys.png" width="480px"
				alt='":)" и "(hug)" для "черных" и "белых" пикселей соответственно' >
			
			<p>
				<img src="illustrations/non-contrast-smileys.png" width="480px"
				alt='"(drink)" и "(dance)" для "черных" и "белых" пикселей соответственно' >
			
						
		<p>
			С клиентом для Linux есть нюанс (и для Windows-версии тоже, может быть). Если в самом начале сообщения 
			не поставить перевод строки (<kbd>Shift</kbd> + <kdb>Enter</kdb>), то самый первый ряд "пикселей" останется
			на одной строке со временем отправки сообщения. Эта особенность продемонстрирована на 
			<a href="#illustration-2">рисунке 2</a>. А вот в Web-приложении все будет выглядеть хорошо: время отправки
			сообщения отбражается немного поодаль справа
			
			
			 (в Web-приложении в самом начале сообщения нельзя
			втавить перевод строки вообще, т.е вставить можно, но он не отобразиться. Видимо, перед самой отправкой  
			пустые строки в самом начале 
			и в конце сообщения отбрасываются).
			
		<h2>И все-таки</h2>	
		
		<p>
			Нужно помнить обо всех ограничениях. Иначе тщательно составленное сообщение покорежится и потеряет эффектный вид.
			Конечно же, можно все это автоматизировать: и автоматическую замену "пикселей" на смайлики, и поддержку 
			"цветов", и собственно отправку (ну не копипастить же каждое новое слово из текстового редактора в Skype).
			И программу автоматизации нужно будет хорошенько отладить, проверить на нестандартных данных и т.д. А вообще, 
			написание бота для Skype - отдельная задача. И там есть где развернуться.
			
			
		<p>
			Идеальным вариантом был бы автоматический подбор оптимального размера шрифта. Т.е. с помощью специального
			бота, работающего от имени тестового аккаунта, отправляются сообщения разной длины. А затем бот "захватывает"
			реально отображаемый текст и  методом двоичного
			поиска выбирается самая большая длина. По сути дела, выбирается наибольшее разрешение символа, т.е. может быть
			не 7x7, а скажем, 10x10. Ну и шрифты можно генерировать вручную (хотя может получиться так, что подобрать уже
			растровый шрифт для матрицы 10x10 будем посложнее, чем для матрицы 7x7).
		
		<p>
			__________
			<ol>
				<li id="footnote-1-bottom">
					<p>
						<a href="#footnote-1-top" title="Перейти к основному тексту">&uarr;</a> 
						Как известно, нажатие Enter приводит к отправке сообщения. Чтобы перейти на новую строку нужно 
						нажать <kbd>Shitf</kbd> + <kbd>Enter</kbd>.
						
				<li id="footnote-2-bottom">
					<p>
						<a href="#footnote-2-top" title="Перейти к основному тексту">&uarr;</a> 
						"Разбивает строку" означает здесь, что Skype только отображает одну длинную строку на нескольких
						строках. Но Skype не вставляет символ(ы) начала новой строки/возврата каретки. Т.е. если в 
						области сообщений выделить строку и скопировать ее в буфер обмена, то она "вытянется" и примет
						первоначальную длину.
						
				<li id="footnote-3-bottom">
					<p>						
						<a href="#footnote-3-top" title="Перейти к основному тексту">&uarr;</a> 
						Может это был глюк синхронизации аккаунтов? Или результат дополнительных проверок, 
						присутствующих только в Web-версии? Непонятно...
						
				<li id="footnote-4-bottom">
					<p>						
						<a href="#footnote-4-top" title="Перейти к основному тексту">&uarr;</a> 
						В качестве "белого" пикселя проще было бы взять пробел. Но лучше использовать дефис. Потому что 
						он всегда хорошо виден. А пробелов можно напечатать сколько угодно, и все равно в текстовом
						редакторе строчка будет выглядеть пустой.
			</ol>
			
		<hr>
		
		<h1>
			<big>
				<a href="#" title="Перейти к началу страницы">&uarr;</a>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				<a href="/" title="Перейти на главную страницу">&#8962;</a>
			</big>
		</h1>
	</body>
</html>
