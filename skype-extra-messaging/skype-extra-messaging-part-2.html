<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>"Креативные" сообщения в Skype. Часть 2</title>
	</head>
	<body>
		<h1>
			<big>
				<a href="/" title="Перейти на главную страницу">&#8962;</a>
			</big>
		</h1>
		
		<hr>
		
		<h1>
			<a href="http://flaz14.github.io/skype-extra-messaging/skype-extra-messaging-part-2.html">
				"Креативные" сообщения в Skype. Часть 2
			</a>
		</h1>
		
		<h3>[2017, Март]</h3>
		
		<h3>
			<a href="skype-extra-messaging-part-1.html">Часть 1</a>
			|
			<a href="skype-extra-messaging-part-3.html">Часть 3</a>
			|
			<a href="тут будет ссылка на исходный код">
				Исходный код
			</a>
		</h3>
		
		<h2>Что может пойти не так</h2>
		
		<p>
			<ol>
				<li>
					<h4>Ограниченная длина строки</h4>
					
					<p>
						Если строка в сообщении <sup id="footnote-1-top"><a href="#footnote-1-bottom">[1]</a></sup> 
						очень длинная, то Skype разбивает ее по границам слов (т.е. по пробелам). Если же строка не 
						содержит пробелов и при этом не помещается по ширине в область сообщений, Skype все равно 
						разбивает такую строку <sup id="footnote-2-top"><a href="#footnote-2-bottom">[2]</a></sup>. 
						Нужно использовать строки умеренной длины. Опытным путем было выяснено, что 7 смайликов 
						помещаются и отображаются безо всяких переносов.
					
				<li>
					<h4>Ограниченная длина сообщения</h4>
					
					<p>
						Если сообщение очень длинное, то Skype обрезает его до определенного количества символов и 
						вместо выброшенных ставит многоточие <tt>...</tt> (по крайней мере, в версии для Linux). 
						Возможно, в Web-приложении ограничений на длину сообщения нет (бесконечная прокрутка все-таки).
						Опытным путем было выяснено, что в версии для Linux (при использование буквы размером 7x7 
						смайликов) ограничение составляет 327 строк. А вот уже 328-ая строка обрезается (смайлики 
						отображаются в виде простого текста, отбрасываемые символы заменяются многоточием. В Web-версии 
						длинное сообщение вообще не отобразилось 
						<sup id="footnote-3-top"><a href="#footnote-3-bottom">[3]</a>.
						 
				
			</ol>
		
		<p>
			Вообще, ограничения могут быть разными для разных версий Skype. Кроме того, они могут меняться, как 
			говорится, без предварительного уведомления пользователя. 7x7 - вполне нормальный размер для "смайликового"
			(по сути дела, растрового) шрифта. Хотя плавность линий при таком низком "разрешении" будет страдать.
			
		<h2>"Рисуем" буквы</h2>
	
		<p>
			Сделаем сначала заготовку. Она будет состоять из семи строк по семь символов в каждой строке. В качестве 
			"белого" пикселя возьмем <b>-</b> <sup id="footnote-4-top"><a href="#footnote-4-bottom">[4]</a>, а в 
			качестве "черного" воспользуемся <b>*</b>. Оставим по одному ряду "белых" пикселей сверху и снизу, чтобы 
			после соедениния букв в слово они не слипались (и не только для этого: лишний ряд окажется нелишним для 
			особенных букв, таких как <b>Й</b> и <b>Ё</b>). Вот, к примеру, буква <b>А</b>:
			
<pre>
-------
--***--
-*---*-
-*****-
-*---*-
-*---*-
-------
</pre>	
		
		<p>
			Применительно к букве <b>А</b> получилось сделать плавные очертания, если вообще уместно применить это слово
			здесь. У буквы <b>Й</b> вместо "шляпки" будет просто один черный пиксель. Букву <b>Ж</b> никак не получилось
			сделать симпатичной. А буквы <b>Ш</b> и <b>Щ</b> - контрастными: "хвостик",	характертный для <b>Щ</b> - это
			всего лишь один пиксель! Как бы то ни было, получившийся алфавит можно увидеть в файле 
			<a href="">abc.txt</a> !!!тут будет ссылка!!! Или же взять готовый шрифт. Или же сгенерировать с каким 
			угодно стиле на сайтах вроде 
			<a href="http://patorjk.com/software/taag/#p=display&f=Graffiti&t=Type%20Something%20">
				Text to ASCII Art Generator (TAAG)</a>. 
				
		<h2>Переводим текст в смайлики</h2>
		
		<p>
			Наверное, самый простой путь - взять в качестве "цвета" фона обычный смайлик <b>:)</b>, а в качестве "цвета"
			шрифта - мишку <b>(hug)</b>. 
						Собственно, добавить смайлики несложно. Достаточно заменить везде в тексте <b>-</b> на <b>:)</b>, а <b>*</b>
			на <b>(hug)</b>. 
			
			Наверное, это наиболее уместные смайлики (по крайней мере, при написании приветствия).
			 Потому что обычный смайлик - самый
			распространенный, и мишка подходит. Но самое главное, что цвет мишки (в основном бурый) и цвет смайлика 
			(в осносном желтый) контрастируют друг с другом. И "буква" хорошо читается. Сравните буквы "П", набранные контрастными
			смайликами и неконтрастными смайликами (см. рисунок 1)
			
		<p>
			Есть еще один нюанс с клиентом для Linux (и для Windows-версии тоже, может быть). Если в самом начале сообщения 
			не поставить перевод строки (<kbd>Shift</kbd> + <kdb>Enter</kdb>), то самый первый ряд "пикселей" останется
			на одной строке со временем отправки сообщения. Эта особенность продемонстрирована на рисунке 2. А вот в 
			Web-приложении все будет выглядеть хорошо
			время отправки сообщения отбражается немного поодаль справа (в Web-приложении в самом начале сообщения нельзя
			втавить перевод строки вообще, т.е вставить можно, но он не отобразиться. Видимо, перед самой отправкой  
			пустые строки в самом начале 
			и в конце сообщения отбрасываются).
			
		<h2>И все-таки</h2>	
		
		<p>
			Нужно помнить обо всех ограничениях. Иначе тщательно составленное сообщение покорежится и потеряет эффектный вид.
			Конечно же, можно все это автоматизировать: и автоматическую замену "пикселей" на смайлики, и поддержку 
			"цветов", и собственно отправку (ну не копипастить же каждое новое слово из текстового редактора в Skype).
			И программу автоматизации нужно будет хорошенько отладить, проверить на нестандартных данных и т.д. А вообще, 
			написание бота для Skype - отдельная задача. И там есть где развернуться.
			
			
		<p>
			Идеальным вариантом был бы автоматический подбор оптимального размера шрифта. Т.е. с помощью специального
			бота, работающего от имени тестового аккаунта, отправляются сообщения разной длины. А затем бот "захватывает"
			реально отображаемый текст и  методом двоичного
			поиска выбирается самая большая длина. По сути дела, выбирается наибольшее разрешение символа, т.е. может быть
			не 7x7, а скажем, 10x10. Ну и шрифты можно генерировать вручную (хотя может получиться так, что подобрать уже
			растровый шрифт для матрицы 10x10 будем посложнее, чем для матрицы 7x7).
		
		<p>
			__________
			<ol>
				<li id="footnote-1-bottom">
					<p>
						<a href="#footnote-1-top" title="Перейти к основному тексту">&uarr;</a> 
						(как известно, нажатие Enter приводит к отправке сообщения; чтобы начать новую строку
						нужно нажать Shitf + Enter).
						
				<li id="footnote-2-bottom">
					<p>
						<a href="#footnote-2-top" title="Перейти к основному тексту">&uarr;</a> 
						"Разбивает строку" означает здесь, что Skype только отображает одну длинную строку на нескольких
						строках. Но Skype не вставляет символ(ы) возврата каретки/переноса на новую строку. Т.е. если 
						в области сообщений выделить строку и скопировать ее в буфер обмена, она "вытянется".
						
				<li id="footnote-3-bottom">
					<p>						
						<a href="#footnote-3-top" title="Перейти к основному тексту">&uarr;</a> 
						Может это был глюк синхронизации аккаунтов? Или результат дополнительных проверок, 
						присутствующих тольк в Web-версии? Непонятно...
						
				<li id="footnote-4-bottom">
					<p>						
						<a href="#footnote-4-top" title="Перейти к основному тексту">&uarr;</a> 
						В качестве 
			</ol>
			
		<hr>
		
		<h1>
			<big>
				<a href="#" title="Перейти к началу страницы">&uarr;</a>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				<a href="/" title="Перейти на главную страницу">&#8962;</a>
			</big>
		</h1>
	</body>
</html>
